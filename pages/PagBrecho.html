<!DOCTYPE HTML>
<html lang="pt-br">

<head>
	<title>CLO-PERFIL</title>
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta charset="UTF-8">

	<link rel="icon" href="../images/logo.ico">

	<link href="https://fonts.googleapis.com/css?family=Poppins:400,500,600,700%7CAllura" rel="stylesheet">

	<link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
		integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css"
		integrity="sha384-JcKb8q3iqJ61gNV9KGb8thSsNjpSL0n8PARn9HuZOnIxN0hoP+VmmDGMN5t9UJ0Z" crossorigin="anonymous">

	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
		integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">

	<link rel="stylesheet" href="../css/profile.css">

	<link rel="stylesheet" href="../css/hover.css">

	<link rel="stylesheet" href="../css/scroll.css">

	<link href="../css/profile-res.css" rel="stylesheet">

</head>

<body>
	<!-- btns  -->

	

	<!-- fim dos btns  -->

	<!-- infos  -->
	<div class="hdr">
		<header class="hdr mt-5">
			<div class="container">
				<div class="heading-wrapper">
					<div class="row">
						<div class="col-sm-12 col-md-12 col-lg-4">
							<div class="info">
								<i class="icon fas fa-map-marker-alt"></i>
								<div class="right-area">
									<h5>Endereço:</h5>
									<p class="txtheader"><span id="rua"></span>, <span id="numero"></span>, <span
											id="complemento"></span></p>
								</div>
							</div>
						</div>

						<div class="col-sm-12 col-md-12 col-lg-4">
							<div class="info">
								<i class="icon fas fa-phone-alt"></i>
								<div class="right-area">
									<h5>Telefone:</h5>
									<p class="txtheader" id="telephone"></p>
								</div>
							</div>
						</div>

						<div class="col-sm-12 col-md-12 col-lg-4">
							<div class="info">
								<i class="icon fas fa-envelope"></i>
								<div class="right-area">
									<h5>Email:</h5>
									<p class="txtheader" id="email"></p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</header>
	</div>
	<!-- fim das infos  -->

	<!-- perfil  -->
	<section class="intro-section hdr">
		<div class="container-fluid">
			<div class="row px-5">
				<a class="btn02 mt-3" href="../index.html"><i class="fas fa-arrow-left"></i></a>
			</div>
		</div>
		<div class="container">
			<div class="row">
				<div class="col-md-1 col-lg-2"></div>
				<div class="col-md-10 col-lg-8">
					<div class="intro">
						<div class="profile-img"><img src="../images/shop.png" id="imagePerfil" alt=""></div>
						<h2 id="nome"><b></b></h2>
						<div class="star-rating2">
							<ul class="list-inline">
								<li class="list-inline-item"><i class="fa fa-star"></i> <span>Média de avalicação:
									</span> <span id="MediaAvaliacao"></span></li>
							</ul>
						</div>
						<div class="information margin-tb-30">
							<div class="text-justify"><b>SOBRE: </b><span id="descricao"></span></div>
						</div>
						<!-- <ul class="social-icons">
							<li><a href="#"><i class="fab fa-facebook"></i></a></li>
							<li><a href="#"><i class="fab fa-instagram"></i></a></li>
							<li><a href="#"><i class="fab fa-twitter"></i></a></li>
						</ul> -->
					</div>
				</div>
			</div>
		</div>
	</section>
	<!-- fim do perfil  -->

	<!-- searchbar -->
	
	<div class="container schb">
		<div class="row mt-5">
			<div class="col-8 col-lg-10 col-md-10 col-sm-8 input-group searchbar">
				<input type="text" class="form-control" placeholder="Buscar um produto...">
				<div class="input-group-append">
					<button class="btn btn-secondary" type="button">
						<i class="fa fa-search"></i>
					</button>
				</div>
			</div>
			<div class="dropdown col-4 col-lg-2 col-md-2 col-sm-4 dropd">
				<button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownMenuButton"
					data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
					Classificar Por:
				</button>
				<div class="dropdown-menu" aria-labelledby="dropdownMenuButton">
					<a class="dropdown-item" href="#">Menor Preço</a>
					<a class="dropdown-item" href="#">Maior Preço</a>
					<a class="dropdown-item" href="#">Mais Antigo</a>
					<a class="dropdown-item" href="#">Mais Novo</a>
				</div>
			</div>
		</div>
	</div>

	<!-- fim da searchbar  -->

	<!-- botao adicionar  -->

	<!-- fim botao adicionar  -->
	

	<!-- produtos  -->
	<div class="container cards-p">
		<div class="title1 mb-3">
			<h2>Produtos</h2>
		</div>		
		<div class="produtos">
			 <div class="row" id="produtos">

			</div> 
		</div>
	</div>

	<div class="col-12 mb-5 text-center">
		<a href="#" class="seemore">Ver Mais...</a>
	</div>
	<!-- fim dos produtos  -->

	<!-- avaliacao -->

	<div class="container containeraval mb-5">

		<p class="titleaval text-center text-uppercase mb-2"> Deixe sua avaliação</p>
		<div class="col-12 row mx-auto">
			<input type="text" class="form-control col-6 inputaval" id="ValorAvaliacao" placeholder="Nota de 0 a 10">
			<input type="text" class="form-control col-6 inputaval" id="ComentarioAvaliacao" placeholder="Deixe seu comentário">
		</div>
		<div class="text-center mt-2">
			<button type="button" class="btn btnaval btn-secondary ml-2" id="avaliar">avaliar</button>
		</div>
		<div class="avaliações">
			
		</div>
	</div>

	<!-- fim da avaliacao  -->

	<!-- Footer -->
	<footer class="page-footer footer font-small blue pt-4">
		<!-- Footer Links -->
		<div class="container text-center text-md-left">

			<!-- Grid row -->
			<div class="row">

				<!-- Grid column -->
				<div class="col-md-6 mt-md-0 mt-3">

					<!-- Content -->
					<h5 class="text-light">Clo</h5>
					<p>"Clo" é um serviço que reune os melhores brechós do Brasil e facilita a compra do usuário.</p>

				</div>
				<!-- Grid column -->

				<hr class="clearfix w-100 d-md-none pb-3">

				<!-- Grid column -->
				<div class="col-md-3 mb-md-0 mb-3">

					<!-- Links -->
					<h5 class="text-light">Links</h5>

					<ul class="list-unstyled">
						<li>
							<a href="#">Home</a>
						</li>
						<li>
							<a href="pages/login.html">Perfil</a>
						</li>
						<li>
							<a href="pages/cart.html">Sacola</a>
						</li>
					</ul>

				</div>
				<!-- Grid column -->

				<!-- Grid column -->
				<div class="col-md-3 mb-md-0 mb-3">

					<!-- Links -->
					<h5 class="text-light">Redes Sociais</h5>

					<ul class="list-unstyled">
						<li>
							<a href="">Instagram</a>
						</li>
						<li>
							<a href="">Facebook</a>
						</li>
						<li>
							<a href="">Twitter</a>
						</li>
					</ul>

				</div>
				<!-- Grid column -->

			</div>
			<!-- Grid row -->

		</div>
		<!-- Footer Links -->

		<!-- Copyright -->
		<div class="footer-copyright text-center py-3 mt-3">© 2020 Copyright:
			<a href="https://mdbootstrap.com/">clo.com.br</a>
		</div>
		<!-- Copyright -->

	</footer>
	<!-- Footer -->


	<!-- SCIPTS -->

	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
		integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"
		integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN"
		crossorigin="anonymous"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"
		integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV"
		crossorigin="anonymous"></script>

	<script>
		var form = document.querySelector('form')
		var error = document.getElementById("error")

		var nome = document.getElementById("nome")
		var telephone = document.getElementById("telephone")
		var txtEmail = document.getElementById('email')
		var rua = document.getElementById('rua')
		var numero = document.getElementById('numero')
		var complemento = document.getElementById('complemento')
		var imagePeril = document.getElementById('imagePeril')
		var descricao = document.getElementById('descricao')
		var MediaAvaliacao = document.getElementById('MediaAvaliacao')
		var imagePerfil = document.getElementById('imagePerfil')
		var imageBanner = document.getElementById('imageBanner')
		
		var avaliar = document.getElementById('avaliar')

		var alterarDados = document.getElementById('alterarDados')
		var addProduto = document.getElementById('addProduto')
		// console.log(descricao)
		document.addEventListener("DOMContentLoaded", function () {

			fetch(`https://clo2020.herokuapp.com/loadAdm`, {
				method: "get",
				headers: { 'Content-Type': 'application/json', 'Authorization': localStorage.getItem('token') }

			})
			.then((resposta) => {
				resposta.json().then((dados) => {
					if(!dados){
						addProduto.style.visibility = 'hidden'
						alterarDados.style.visibility = 'hidden'
					}
					// if (dados.message) {
					// 	return window.location = '404.html'
					// }
					console.log(dados._id)
					var { name, phone, email, password, street, numberHouse, complement, image, description, mediaEvaluation, evaluation, products } = dados;
					// console.log(evaluation)
					nome.textContent = name
					telephone.textContent = phone
					txtEmail.textContent = email
					rua.textContent = street
					numero.textContent = numberHouse,
					complemento.textContent = complement
					descricao.textContent = description,
					MediaAvaliacao.textContent = mediaEvaluation.toFixed(2)

					if (image) {
						imagePerfil.src = image.location
					}
					if(imageBanner){
						imageBanner.src = imageBanner.location
					}
					var avalicações = ""

					for (let i = 0; i < evaluation.length; i++) {
						avalicações +=
						"<div class='row mb-5 aval'>" +
						"<p id='valorAvalido' class='rating col-3 col-xl-1 col-lg-1 col-md-2'>" +evaluation[i].avaliate+" <i class='fa fa-star'></i> </p>"+ 
						"<p id='comentarioAvalido' class='comment'> Comentário: "+evaluation[i].comment+"</p>" +
						"</div>"
					}
					$('.avaliações').html(avalicações)

					console.log(dados)
					
					// Exibindo produtos
					var produtos = ""

					for (let i = 0; i < products.length; i++) {
						produtos += 
							"<div class='col-xl-3 col-lg-3 col-md-4 col-sm-6 col-xs-6'>"+
								"<div class='thumb-wrapper'>"+
									"<div class='img-box'>"+
										"<img id='imagePeril' src='"+products[i].image.location+"' class='img-fluid'>"+
									"</div>"+
									"<div class='thumb-content'>"+
										"<h4>"+products[i].style+"</h4>"+
										"<p class='item-price'>R$"+products[i].price+""+
										"</p>"+
										"<p class='item-name mt-1 mb-3'>"+name+"</p>"+
										
										"<a href='#' class='btn btn-primary'>Adicionar ao Carrinho</a>"+
									"</div>"+
								"</div>"+
							"</div>"
					}
					$('#produtos').html(produtos)

				})
			})
		})



		avaliar.addEventListener('click', function() {
            
			var ValorAvaliacao = document.getElementById('ValorAvaliacao')
			var ComentarioAvaliacao = document.getElementById('ComentarioAvaliacao')
			console.log(ValorAvaliacao.value)
			console.log(ComentarioAvaliacao.value)
			fetch(`https://clo2020.herokuapp.com/evaluationAdm/5f96ce2f1eea19524c924bbf`, {
				method: "POST",
				headers: { 'Content-Type': 'application/json', 'Authorization': localStorage.getItem('token') },
				body: JSON.stringify({                    
					avaliate: ValorAvaliacao.value,
					comment: ComentarioAvaliacao.value

                })             
			})
				.then((resposta) => {
					resposta.json().then((dados) => {						
						var { evaluation } = dados;

						console.log(dados)
						
						for(avaliations of evaluation){

							console.log(avaliations)

						}

					})
				})
			})
	</script>
</body>

</html>